{% extends "base.html" %}

{% block title %}Password reset confirmation{% endblock %}

{% block phase_banner %}{% endblock %}

{% block content %}
    <main id="main-content" class="govuk-main-wrapper">
        {% if validlink %}
            <div class="region login govuk-width-container">
                <h1 class="govuk-heading-l">Please enter your new password.</h1>
                <div class="form_default">
                    <form id="fm1" action="" method="post">
                        {% csrf_token %}
                        <div class="form-group">
                            <label class="govuk-label govuk-label--m" for="{{form.new_password1.auto_id}}">
                                New password
                            </label>
                            {{form.new_password1}}
                            <span class="govuk-error-message">
                                <span class="govuk-visually-hidden">Error:</span>
                                {{ form.new_password1.errors }}
                            </span>

                            <label class="govuk-label govuk-label--m" for="{{form.new_password2.auto_id}}">
                                Confirm password
                            </label>
                            {{form.new_password2}}
                            <span class="govuk-error-message">
                                <span class="govuk-visually-hidden">Error:</span>
                                {{ form.new_password2.errors }}
                            </span>

                            <input type="submit" value="Change my password" class="govuk-button" data-module="govuk-button">

                            <div class="govuk-body">
                                {{form.new_password1.help_text}}
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        {% else %}
            <div class="govuk-width-container">
                <span id="more-detail-error-message-header" class="govuk-error-message">
                    <span class="govuk-visually-hidden">Error:</span>
                    Password reset failed
                </span>
                <span id="more-detail-error-message-detail" class="govuk-error-message">
                    <span class="govuk-visually-hidden">Error:</span>
                    The password reset link was invalid, possibly because it has already been used.
                    Please request a new password reset.
                </span>
            </div>
        {% endif %}
    </main>
{% endblock %}
