<div class="govuk-form-group{% if field.errors %} govuk-form-group--error{% endif %}">
    {% if field.field.widget.input_type == 'radio' %}
        <fieldset class="govuk-fieldset">
            <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
                <label id="{{ field.auto_id }}-label" class="govuk-label"><b>{{ field.label }}</b></label>
            </legend>
            {% if field.help_text %}<div class="govuk-hint">{{ field.help_text|safe }}</div>{% endif %}
            {% include 'common/field_errors.html' with errors=field.errors %}
            {{ field }}
        </fieldset>
    {% elif field.field.widget.input_type == 'checkbox' %}
        <fieldset class="govuk-fieldset" aria-describedby="email_notifications-hint">
            <legend id="{{ field.auto_id }}-label" class="govuk-fieldset__legend govuk-fieldset__legend--l amp-margin-bottom-0">
                <span class="govuk-label"><b>{{ field.label }}</b></span>
            </legend>
            {% if field.help_text %}<div class="govuk-hint">{{ field.help_text|safe }}</div>{% endif %}
            {% include 'common/field_errors.html' with errors=field.errors %}
            {{ field }}
        </fieldset>
    {% else %}
        <label id="{{ field.auto_id }}-label" class="govuk-label" for="{{ field.auto_id }}"><b>{{ field.label }}</b></label>
        {% if field.help_text %}<div class="govuk-hint">{{ field.help_text|safe }}</div>{% endif %}
        {% include 'common/field_errors.html' with errors=field.errors %}
        {{ field }}
    {% endif %}
    {% if field.field.note_type %}
        {% with case|filtered_case_note_history:field.field.note_type as filtered_case_note_history %}
            <details class="govuk-details amp-margin-bottom-5" data-module="govuk-details"{% if filtered_case_note_history %} open{% endif %}>
                <summary class="govuk-details__summary">
                    <span class="govuk-details__summary-text">{{ field.field.label }} history ({{ filtered_case_note_history|length}})</span>
                </summary>
                <div class="govuk-details__text">
                    {% if filtered_case_note_history %}
                        {% for note in filtered_case_note_history %}
                            <p>{{ note.note|markdown_to_html }}</p>
                            <p>
                                <i>
                                    {% if note.user %}
                                        By {{ note.user.get_full_name }} on {{ note.created|amp_datetime }}
                                    {% else %}
                                        Note entered before history implemented
                                    {% endif %}
                                </i>
                            </p>
                        {% endfor %}
                    {% else %}
                        None
                    {% endif %}
                </div>
            </details>
        {% endwith %}
    {% endif %}
</div>
