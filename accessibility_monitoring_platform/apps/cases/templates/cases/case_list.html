<!DOCTYPE html>

{% extends 'base.html' %}

{% load l10n %}

{% block content %}
<div class="govuk-width-container">
    <main class="govuk-main-wrapper">
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-two-thirds">
                <h1 class="govuk-heading-xl">Cases and reports</h1>
            </div>
        </div>
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-two-thirds">
                <h2 class="govuk-heading-m">{{ page_obj.paginator.count|localize }} cases found</h2>
                {% include "common/pagination_controls.html" %}
                <table class="govuk-table">
                    <tbody class="govuk-table__body">
                    {% for case in cases %}
                        <tr class="govuk-table__row">
                            <td class="govuk-table__cell">
                                <div class="govuk-grid-row">
                                    <div class="govuk-grid-column-full">
                                        <a href="{% url 'cases:case-detail' case.id %}" class="govuk-link cases-bigger-link"
                                            rel="noreferrer noopener">
                                            Case #{{ case.id }}</a>
                                        <h3 class="govuk-heading-s cases-sub-heading">{{ case.organisation_name }}</h3>
                                        <p class="govuk-body-m">{{ case.domain }}</p>
                                    </div>
                                </div>
                                <div class="govuk-grid-row">
                                    <div class="govuk-grid-column-one-half">
                                        <h3 class="govuk-heading-s cases-sub-heading">Date created</h3>
                                        <p class="govuk-body-m">{{ case.created|date:"d/m/Y" }}</p>
                                    </div>
                                    <div class="govuk-grid-column-one-half">
                                        <h3 class="govuk-heading-s cases-sub-heading">Auditor</h3>
                                        <p class="govuk-body-m">{{ case.auditor.get_full_name }}</p>
                                    </div>
                                </div>
                                <div class="govuk-grid-row">
                                    <div class="govuk-grid-column-one-half">
                                        <h3 class="govuk-heading-s cases-sub-heading">Status</h3>
                                        <p class="govuk-body-m">{{ case.get_status_display }}</p>
                                    </div>
                                    <div class="govuk-grid-column-one-half">
                                        <h3 class="govuk-heading-s cases-sub-heading">QA Auditor</h3>
                                        <p class="govuk-body-m">{{ case.reviewer.get_full_name }}</p>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                {% include "common/pagination_controls.html" %}
            </div>
            <div class="govuk-grid-column-one-third">
                <div class="govuk-grid-row">
                    <div class="govuk-grid-column-full">
                        <div class="govuk-button-group">
                            <a
                                href="{% url 'cases:case-create' %}"
                                role="button"
                                draggable="false"
                                class="govuk-button"
                                data-module="govuk-button"
                            >
                                Create case
                            </a>
                            <a
                                href="{% url 'cases:case-export-list' %}{% if parameters %}?{{ parameters }}{% endif %}"
                                role="button"
                                draggable="false"
                                class="govuk-button govuk-button--secondary"
                                data-module="govuk-button"
                            >
                                Export to CSV
                            </a>
                        </div>
                    </div>
                </div>
                <div class="govuk-grid-row cases-search-background">
                    <div class="govuk-grid-column-full">
                        <form method="get" action="{% url 'cases:case-list' %}">
                            <div class="govuk-grid-row">
                                <div class="govuk-grid-column-full">
                                    <h2 class="govuk-heading-m cases-margin-top">Edit search</h2>
                                </div>
                                <div class="govuk-grid-column-full govuk-form-group">
                                    <label class="govuk-label" for="{{ form.sort_by.auto_id }}"><b>{{form.sort_by.label}}</b></label>
                                    {{form.sort_by}}
                                </div>
                                <div class="govuk-grid-column-full govuk-form-group">
                                    <label class="govuk-label" for="{{ form.case_number.auto_id }}"><b>{{form.case_number.label}}</b></label>
                                    {{form.case_number}}
                                </div>
                                <div class="govuk-grid-column-full govuk-form-group">
                                    <label class="govuk-label" for="{{ form.domain.auto_id }}"><b>{{form.domain.label}}</b></label>
                                    {{form.domain}}
                                </div>
                                <div class="govuk-grid-column-full govuk-form-group">
                                    <label class="govuk-label" for="{{ form.organisation.auto_id }}"><b>{{form.organisation.label}}</b></label>
                                    {{form.organisation}}
                                </div>
                                <div class="govuk-grid-column-full govuk-form-group">
                                    <label class="govuk-label" for="{{ form.auditor.auto_id }}"><b>{{form.auditor.label}}</b></label>
                                    {{form.auditor}}
                                </div>
                                <div class="govuk-grid-column-full govuk-form-group">
                                    <label class="govuk-label" for="{{ form.reviewer.auto_id }}"><b>{{form.reviewer.label}}</b></label>
                                    {{form.reviewer}}
                                </div>
                                <div class="govuk-grid-column-full govuk-form-group">
                                    <label class="govuk-label" for="{{ form.status.auto_id }}"><b>{{form.status.label}}</b></label>
                                    {{form.status}}
                                </div>
                                <div class="govuk-grid-column-full govuk-form-group">
                                    <h3 class="govuk-heading-s cases-sub-heading">Date created filter</h3>
                                </div>
                                <div class="govuk-grid-column-full govuk-form-group">
                                    <label class="govuk-label" for="{{ form.status.auto_id }}">{{form.start_date.label}}</label>
                                    {{form.start_date}}
                                </div>
                                <div class="govuk-grid-column-full govuk-form-group">
                                    <label class="govuk-label" for="{{ form.status.auto_id }}">{{form.end_date.label}}</label>
                                    {{form.end_date}}
                                </div>
                            </div>
                            <div class="govuk-button-group">
                                <input
                                    type="submit"
                                    value="Search"
                                    class="govuk-button"
                                    data-module="govuk-button"
                                />
                                <a href="{% url 'cases:case-list' %}" class="govuk-button govuk-button--secondary">
                                    Clear
                                </a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>
{% endblock %}
